<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>USBConnection Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>USBConnection Class Reference</h1><!-- doxytag: class="USBConnection" --><!-- doxytag: inherits="Connection" -->
<p><a class="el" href="classUSBConnection.html" title="USBConnection class is the child of the Connection class used for USB communitcation...">USBConnection</a> class is the child of the <a class="el" href="classConnection.html" title="Connection class is the parent of all connections.">Connection</a> class used for USB communitcation.  
<a href="#_details">More...</a></p>
<div class="dynheader">
Inheritance diagram for USBConnection:</div>
<div class="dynsection">
 <div class="center">
  <img src="classUSBConnection.png" usemap="#USBConnection_map" alt=""/>
  <map id="USBConnection_map" name="USBConnection_map">
<area href="classConnection.html" alt="Connection" shape="rect" coords="0,0,100,24"/>
</map>
 </div>
</div>

<p><a href="classUSBConnection-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a916a50d8bf0eadaa988c46cd4eaa74f6">nxt_connect</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Connect to NXT.   <a href="#a916a50d8bf0eadaa988c46cd4eaa74f6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a462c50fe18f555161a5c14988769ab9a">closeSensorOnPort</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close any sensor on the NXT.   <a href="#a462c50fe18f555161a5c14988769ab9a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#aad7081a7d3f980d2aca8128198f2c9b6">nxt_set_motor</a> (int speed, int motor)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the speed of a given motor.   <a href="#aad7081a7d3f980d2aca8128198f2c9b6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#ab8d42471e207f94f842364eb80e443da">nxt_set_motor_with_limit</a> (int speed, int limit, int motor)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the speed of a given motor for a given time.   <a href="#ab8d42471e207f94f842364eb80e443da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a3e94bea8d3c42eddff5c584dcb2f8013">openSonarOnPort</a> (int port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a sonar sensor to NXT.   <a href="#a3e94bea8d3c42eddff5c584dcb2f8013"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a5056b7f3523584540c3d5b62a83a76ca">setSonorContinuousReadMode</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the Sonar to read continuously.   <a href="#a5056b7f3523584540c3d5b62a83a76ca"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a9400523eb9fb43719a8c5442baeac479">getSonarValue</a> (int port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve a Distance value from the sonar.   <a href="#a9400523eb9fb43719a8c5442baeac479"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a688024d12a2122997d5064a60e2665d8">openLightActiveOnPort</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a active light sensor to NXT.   <a href="#a688024d12a2122997d5064a60e2665d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a20e111782efbe7a4a209537768aec543">openLightPassiveOnPort</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a passive light sensor to NXT.   <a href="#a20e111782efbe7a4a209537768aec543"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a30c0b71168381b04a07d0cf4e314036e">getLightValue</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve an ambient light value from the NXT.   <a href="#a30c0b71168381b04a07d0cf4e314036e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#ab1c6fbbcb6fb7f2f6f4b247f0ad13f93">openSoundOnPort</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a sound sensor to NXT.   <a href="#ab1c6fbbcb6fb7f2f6f4b247f0ad13f93"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a9fe1ca0a730201f1696532d34e043ce7">getSoundValue</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve an sound volume value from the NXT.   <a href="#a9fe1ca0a730201f1696532d34e043ce7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a3bd6a552ee16e25fbd2bd8486abf6f3d">openBumperOnPort</a> (int port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a bumper sensor to NXT.   <a href="#a3bd6a552ee16e25fbd2bd8486abf6f3d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#ae2832a19044dcb05ad40737a0e0d6f0b">getBumperValue</a> (unsigned char port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve an bumper value from the NXT.   <a href="#ae2832a19044dcb05ad40737a0e0d6f0b"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUSBConnection.html#a0cd39f6cd4a0221171e3db49f078c475">DevOpen</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Open USB connection to the nxt.  <a href="#a0cd39f6cd4a0221171e3db49f078c475"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a879f8b658d2940757cebff9e51e65328"></a><!-- doxytag: member="USBConnection::DevInit" ref="a879f8b658d2940757cebff9e51e65328" args="(void)" -->
static struct usb_device *&nbsp;</td><td class="memItemRight" valign="bottom"><b>DevInit</b> (void)</td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a682e95e218dfd21fc435be469a375e00"></a><!-- doxytag: member="USBConnection::pUSBHandle" ref="a682e95e218dfd21fc435be469a375e00" args="" -->
usb_dev_handle *&nbsp;</td><td class="memItemRight" valign="bottom"><b>pUSBHandle</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3ab9f1e8e83cb82c8676ba67643619f5"></a><!-- doxytag: member="USBConnection::ucEpOut" ref="a3ab9f1e8e83cb82c8676ba67643619f5" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><b>ucEpOut</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab46e601bbc1d45b9a13d7381d923d34d"></a><!-- doxytag: member="USBConnection::ucEpIn" ref="ab46e601bbc1d45b9a13d7381d923d34d" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><b>ucEpIn</b></td></tr>
<tr><td colspan="2"><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93a053fdc1e7eb10fd20d1c03e9aea73"></a><!-- doxytag: member="USBConnection::NXT_VENDOR_ID" ref="a93a053fdc1e7eb10fd20d1c03e9aea73" args="" -->
static const int&nbsp;</td><td class="memItemRight" valign="bottom"><b>NXT_VENDOR_ID</b> = 0x0694</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a969ee03a8ce33a1816541d7ab2764d07"></a><!-- doxytag: member="USBConnection::NXT_PRODUCT_ID" ref="a969ee03a8ce33a1816541d7ab2764d07" args="" -->
static const int&nbsp;</td><td class="memItemRight" valign="bottom"><b>NXT_PRODUCT_ID</b> = 0x0002</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad98f091b5ea4bdb8df47f3e7d1aa2fa2"></a><!-- doxytag: member="USBConnection::TIMEOUT" ref="ad98f091b5ea4bdb8df47f3e7d1aa2fa2" args="" -->
static const int&nbsp;</td><td class="memItemRight" valign="bottom"><b>TIMEOUT</b> = 0x0BB8</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classUSBConnection.html" title="USBConnection class is the child of the Connection class used for USB communitcation...">USBConnection</a> class is the child of the <a class="el" href="classConnection.html" title="Connection class is the parent of all connections.">Connection</a> class used for USB communitcation. </p>
<p>This is the USB version of the <a class="el" href="classConnection.html" title="Connection class is the parent of all connections.">Connection</a> class. It should be 100% functional when it is cast to a connection or vice versa.... </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classConnection.html" title="Connection class is the parent of all connections.">Connection</a> </dd>
<dd>
<a class="el" href="classBTConnection.html" title="BTConnection class is the child of the Connection class used for Bluetooth communitcation...">BTConnection</a> </dd></dl>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a462c50fe18f555161a5c14988769ab9a"></a><!-- doxytag: member="USBConnection::closeSensorOnPort" ref="a462c50fe18f555161a5c14988769ab9a" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::closeSensorOnPort </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close any sensor on the NXT.  </p>
<p>Close any type of sensor at the specified port on the NXT.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to close the NXT on.</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>Sends the SetInputMode direct command to the NXT, see NXT documentation for more details. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x05 --direct command number 5 for SetInputMode</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x00 --sensor type -- no sensor</p>
<p>byte[4] = 0x00 --sensor mode -- raw mode (this is irelevent as there is no sensor) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#ab5f8e86a876fdb31d521d09c5a46c789">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a0cd39f6cd4a0221171e3db49f078c475"></a><!-- doxytag: member="USBConnection::DevOpen" ref="a0cd39f6cd4a0221171e3db49f078c475" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool USBConnection::DevOpen </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Open USB connection to the nxt. </p>
<p>USB function to link to the NXT, this should not be called directly. Instead use Connect().</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true for connected, false for error.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classUSBConnection.html#a916a50d8bf0eadaa988c46cd4eaa74f6" title="Connect to NXT. ">nxt_connect()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ae2832a19044dcb05ad40737a0e0d6f0b"></a><!-- doxytag: member="USBConnection::getBumperValue" ref="ae2832a19044dcb05ad40737a0e0d6f0b" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int USBConnection::getBumperValue </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve an bumper value from the NXT.  </p>
<p>Tell the NXT to return the newest bumper value from the bumper sensor at the specified port.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to read from.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns bumper value(1,0).</dd></dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>Reads a bumper sensor value from the NXT. </p>

<p><p>byte[0] = 0x00 --return a value</p>
<p>byte[1] = 0x07 --command - GetInputValues</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#abfa5e09da59623e1c8d6489ce7b4408d">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a30c0b71168381b04a07d0cf4e314036e"></a><!-- doxytag: member="USBConnection::getLightValue" ref="a30c0b71168381b04a07d0cf4e314036e" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int USBConnection::getLightValue </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve an ambient light value from the NXT.  </p>
<p>Tell the NXT to return the newest ambient light value from the light sensor at the specified port.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to read from.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns light value(0-100).</dd></dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>Reads a light sensor value from the NXT. </p>

<p><p>byte[0] = 0x00 --return a value</p>
<p>byte[1] = 0x07 --command - GetInputValues</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#adc7fc1478aab213fe5441b54db6f994f">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a9400523eb9fb43719a8c5442baeac479"></a><!-- doxytag: member="USBConnection::getSonarValue" ref="a9400523eb9fb43719a8c5442baeac479" args="(int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int USBConnection::getSonarValue </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve a Distance value from the sonar.  </p>
<p>Tell the NXT to return the newest sonar value from the sonar at the specified port.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to read from.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns sonar value(0-100).</dd></dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>This function reads from the nxt it keeps sending a read command to to sonar and cheking if the data is ready, once the data is ready it reads and returns it. </p>

<p><p>FIRST COMMAND lswrite, send a packet from the nxt to the sonar telling you want to read a value.</p>
<p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x0F --command - lswrite</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x02 --outgoing package size of 2 (from nxt to sonar, not from me to nxt)</p>
<p>byte[4] = 0x01 --returning package size of 1 (from sonar to nxt, not from nxt to me)</p>
<p>byte[5] = 0x02 --package 1 - from sonar docs - get value</p>
<p>byte[6] = 0x42 --package 1 - from sonar docs - get value</p>
<p>SECOND COMMAND LsGetStatus, check if sonar value is ready to be read.</p>
<p>byte[0] = 0x00 --return a value</p>
<p>byte[1] = 0x0E --command - lsget status</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>EXIT LOOP, FINAL COMMAND lsread.</p>
<p>byte[0] = 0x00 --return a value</p>
<p>byte[1] = 0x10 --command - lsread</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#acbf5e7fe5d9f43aa1877b75e6af78a5e">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a9fe1ca0a730201f1696532d34e043ce7"></a><!-- doxytag: member="USBConnection::getSoundValue" ref="a9fe1ca0a730201f1696532d34e043ce7" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int USBConnection::getSoundValue </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve an sound volume value from the NXT.  </p>
<p>Tell the NXT to return the newest sound volume value from the sound sensor at the specified port.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to read from.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns sound value(0-100).</dd></dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>Reads a sound sensor value from the NXT. </p>

<p><p>byte[0] = 0x00 --return a value</p>
<p>byte[1] = 0x07 --command - GetInputValues</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#a1ca1471faf4742213e1635ed27f379c6">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a916a50d8bf0eadaa988c46cd4eaa74f6"></a><!-- doxytag: member="USBConnection::nxt_connect" ref="a916a50d8bf0eadaa988c46cd4eaa74f6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool USBConnection::nxt_connect </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Connect to NXT.  </p>
<p><a class="el" href="classConnection.html" title="Connection class is the parent of all connections.">Connection</a> function to link to the NXT, this must be called before any other communication can happen.<dl class="return"><dt><b>Returns:</b></dt><dd>1 for connected, 0 for error.</dd></dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>This connect function creates a usb_device object, calls the DevOpen function, and checks if the usb connection is working.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classUSBConnection.html#a0cd39f6cd4a0221171e3db49f078c475" title="Open USB connection to the nxt.">DevOpen()</a> </dd></dl>

<p>Reimplemented from <a class="el" href="classConnection.html#af67d08fa87a63ea617a94d9c8895f650">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="aad7081a7d3f980d2aca8128198f2c9b6"></a><!-- doxytag: member="USBConnection::nxt_set_motor" ref="aad7081a7d3f980d2aca8128198f2c9b6" args="(int speed, int motor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::nxt_set_motor </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>motor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the speed of a given motor.  </p>
<p>Send a speed value to a specified motor that will set that motor to that speed till a new value is recieved.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>speed</em>&nbsp;</td><td>The speed value to send to the motor (0-100). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>motor</em>&nbsp;</td><td>The motor port #(0,1,2 or FF for all 3).</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>Sends the SetOutputState direct command to the nxt. This uses the simplest method for controlling the motors. It sends a power value and motor number pair to the NXT. Which will cause the motor to run at that power untill instructed otherwise. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x04 --set ouput state command</p>
<p>byte[2] = port --integer port value sent to function</p>
<p>byte[3] = power --integer power value sent to function(not checked fror validity)</p>
<p>byte[4] = 0x01 --mode - motor on</p>
<p>byte[5] = 0x00 --regulation mode - none</p>
<p>byte[6] = 0x00 --turn ratio - none (only used in motor sync mode)</p>
<p>byte[7] = 0x20 --run state - running</p>
<p>byte[8] = 0x00 --tach state - run forever (all the tach state variables are combined to one large number that limits the degrees the motor will rotate)</p>
<p>byte[9] = 0x00 --tach state - run forever</p>
<p>byte[10] = 0x00 --tach state - run forever</p>
<p>byte[11] = 0x00 --tach state - run forever</p>
<p>byte[12] = 0x00 --tach state - run forever </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#a95efc2a386e3c43917ba5a7952b2d8f2">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="ab8d42471e207f94f842364eb80e443da"></a><!-- doxytag: member="USBConnection::nxt_set_motor_with_limit" ref="ab8d42471e207f94f842364eb80e443da" args="(int speed, int limit, int motor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::nxt_set_motor_with_limit </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>motor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the speed of a given motor for a given time.  </p>
<p>Send a speed value to a specified motor that will set that motor to that speed for the specifed number of rotations.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>speed</em>&nbsp;</td><td>The speed value to send to the motor (0-100). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>limit</em>&nbsp;</td><td>The number of degrees to turn before the wheel stops (360 = 1 rotation)(0-FFFF). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>motor</em>&nbsp;</td><td>The motor port #(0,1,2 or FF for all 3).</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>This function is the same as the regular set motor function with the exception that it allows you to set a tachometer limit. This prevents the wheel from rotating past a specified number of degrees. It was written with the intent of using it to controll a gripper or arm, that rotates a set number of degrees back and forth. It dosnt work very exactly and in order to make it work better call nxtsetmotor(100) instantly followed by this, to prevent tach limit confusion when changing directions. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x04 --set ouput state command</p>
<p>byte[2] = port --integer port value sent to function</p>
<p>byte[3] = power --integer power value sent to function(not checked fror validity)</p>
<p>byte[4] = 0x01 --mode - motor on</p>
<p>byte[5] = 0x00 --regulation mode - none</p>
<p>byte[6] = 0x00 --turn ratio - none (only used in motor sync mode)</p>
<p>byte[7] = 0x20 --run state - running</p>
<p>byte[8] = limit --tach state - integer limit value sent to function (all the tach state variables are combined to one large number that limits the degrees the motor will rotate. This function only implements the first byte, if you need more fix the code :-P)</p>
<p>byte[9] = 0x00 --tach state - run forever</p>
<p>byte[10] = 0x00 --tach state - run forever</p>
<p>byte[11] = 0x00 --tach state - run forever</p>
<p>byte[12] = 0x00 --tach state - run forever </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#a7c54d54ed0105fc00760ae3629ec0df6">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a3bd6a552ee16e25fbd2bd8486abf6f3d"></a><!-- doxytag: member="USBConnection::openBumperOnPort" ref="a3bd6a552ee16e25fbd2bd8486abf6f3d" args="(int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::openBumperOnPort </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a bumper sensor to NXT.  </p>
<p>Tell the NXT there is a bumper sensor on the specified port.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to add the bumper sensor to.</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>Sends the SetInputMode command configured for the bumper sensor to the NXT. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x05 --command - SetInputMode</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x01 --sensor type - switch</p>
<p>byte[4] = 0x20 --sensor mode - boolean </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#a1f31e995ee54457bfc19e5cbaf96122d">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a688024d12a2122997d5064a60e2665d8"></a><!-- doxytag: member="USBConnection::openLightActiveOnPort" ref="a688024d12a2122997d5064a60e2665d8" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::openLightActiveOnPort </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a active light sensor to NXT.  </p>
<p>Tell the NXT there is a light sensor on the specified port and to turn the sensor's led on.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to add the light sensor to.</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>sends the SetInputMode command configured for the light sensor to the NXT. This function sends the active mode version of the command, which means the LED on the sensor will be on. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x05 --command - SetInputMode</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x05 --sensor type - LIGHT_ACTIVE</p>
<p>byte[4] = 0x80 --sensor mode - PCTFULLSCALEMODE (dunno why but thats what it is :D) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#adb0331f4ddf5e1fa08b2258f4d35139a">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a20e111782efbe7a4a209537768aec543"></a><!-- doxytag: member="USBConnection::openLightPassiveOnPort" ref="a20e111782efbe7a4a209537768aec543" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::openLightPassiveOnPort </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a passive light sensor to NXT.  </p>
<p>Tell the NXT there is a light sensor on the specified port and to turn the sensor's led off.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to add the light sensor to.</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>sends the SetInputMode command configured for the light sensor to the NXT. This function sends the passive mode version of the command, which means the LED on the sensor will be off. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x05 --command - SetInputMode</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x06 --sensor type - LIGHT_INACTIVE</p>
<p>byte[4] = 0x80 --sensor mode - PCTFULLSCALEMODE (dunno why but thats what it is :D) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#a1eb952586d77248743ed9c70f6376521">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a3e94bea8d3c42eddff5c584dcb2f8013"></a><!-- doxytag: member="USBConnection::openSonarOnPort" ref="a3e94bea8d3c42eddff5c584dcb2f8013" args="(int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::openSonarOnPort </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a sonar sensor to NXT.  </p>
<p>Tell the NXT there is a sonar sensor on the specified port.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to add the sonar to.</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>sends SetInputMode command configured for sonar to the nxt on the specified port. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x05 --direct command number 5 for SetInputMode</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x0B --sensor type - LOWSPEED_V9</p>
<p>byte[4] = 0x00 --sensor mode - raw mode </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#ac2b5112afb21987d3c51044505f63f3d">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="ab1c6fbbcb6fb7f2f6f4b247f0ad13f93"></a><!-- doxytag: member="USBConnection::openSoundOnPort" ref="ab1c6fbbcb6fb7f2f6f4b247f0ad13f93" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::openSoundOnPort </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a sound sensor to NXT.  </p>
<p>Tell the NXT there is a sound sensor on the specified port.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to add the sound sensor to.</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>Sends the SetInputMode command configured for the sound sensor to the NXT. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x05 --command - SetInputMode</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x05 --sensor type - LIGHT_INACTIVE (is this a bug??? maybe should be SOUND_DB or something?)</p>
<p>byte[4] = 0x80 --sensor mode - PCTFULLSCALEMODE (dunno why but thats what it is :D) </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#a2e0f63cdc0c1feb8ceb143b25943e28f">Connection</a>.</p>

</div>
</div>
<a class="anchor" id="a5056b7f3523584540c3d5b62a83a76ca"></a><!-- doxytag: member="USBConnection::setSonorContinuousReadMode" ref="a5056b7f3523584540c3d5b62a83a76ca" args="(unsigned char port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USBConnection::setSonorContinuousReadMode </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the Sonar to read continuously.  </p>
<p>Tell the NXT to allways read sonar values while it is running, instead of only when a new value is requested.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>The port to set continous read mode on.</td></tr>
  </table>
  </dd>
</dl>
 </p>
<h2><a class="anchor" id="Implementation">
Implementation</a></h2>
<p>sends a lswrite command to the NXT with a package that will be sent to the sonar module which contains the sonar command to go to continous read mode. For me details see both the direct command, and the sonar documentation. </p>

<p><p>byte[0] = 0x80 --no return</p>
<p>byte[1] = 0x0F --command - lswrite</p>
<p>byte[2] = port --integer port value sent to function (not checked for validity)</p>
<p>byte[3] = 0x03 --outgoing package size of 3 (from nxt to sonar, not from me to nxt)</p>
<p>byte[4] = 0x00 --returning package size of 0 (from sonar to nxt, not from nxt to me)</p>
<p>byte[5] = 0x02 --package 1 - from sonar docs - set continus mode</p>
<p>byte[6] = 0x41 --package 2 - from sonar docs - set continus mode</p>
<p>byte[7] = 0x02 --package 3 - from sonar docs - set continus mode </p>
</p>

<p>Reimplemented from <a class="el" href="classConnection.html#adef82cd6e61b21f45ebbb288d325bba4">Connection</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>USBConnection.cc</li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jun 1 17:35:15 2010 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
